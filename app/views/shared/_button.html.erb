<%
text        = local_assigns[:text] || "Button"
icon_left   = local_assigns[:icon_left]
icon_right  = local_assigns[:icon_right]
variant     = local_assigns[:variant]
size        = local_assigns[:size]
rounded     = !!local_assigns[:rounded]
icon_only   = !!local_assigns[:icon_only]
href        = local_assigns[:href]
type        = local_assigns.fetch(:type, :button)
disabled    = !!local_assigns[:disabled]
aria_attrs  = local_assigns[:aria] || {}
data_attrs  = local_assigns[:data] || {}
title_attr  = local_assigns[:title]
extra_class = local_assigns[:extra_class]

classes = ["btn"]
classes << "btn-primary"   if variant == :primary
classes << "btn-contrast"  if variant == :contrast
classes << "btn-small"     if size == :small
classes << "btn-large"     if size == :large
classes << "btn-rounded"   if rounded
classes << "btn-icon-only" if icon_only
classes << extra_class if extra_class.present?
class_attr = classes.join(" ")
%>

<%# Build inner content %>
<%
icon_left_html  = icon_left.present?  ? content_tag(:span, icon_left.respond_to?(:html_safe) ? icon_left.html_safe : icon_left,   class: "btn-icon btn-icon-left")  : nil
icon_right_html = icon_right.present? ? content_tag(:span, icon_right.respond_to?(:html_safe) ? icon_right.html_safe : icon_right, class: "btn-icon btn-icon-right") : nil
text_html       = icon_only ? nil : content_tag(:span, text)
inner = safe_join([icon_left_html, text_html, icon_right_html].compact)
%>

<% if href.present? %>
  <%= link_to href, class: class_attr, aria: aria_attrs, data: data_attrs, title: title_attr do %>
    <%= inner %>
  <% end %>
<% else %>
  <%= button_tag type: type, class: class_attr, aria: aria_attrs, data: data_attrs, title: title_attr, disabled: disabled do %>
    <%= inner %>
  <% end %>
<% end %>